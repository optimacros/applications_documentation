# Модульная система

Для удобства разработки код больших приложений принято разбивать на небольшие части - модули. Приложения Application Manager используют систему, основанную на require.js

## Создание модуля

Для того, чтобы файл js можно было использовать как модуль, в нем должены быть явно опредлены данные экспорта модуля:

```js
module.exports = 'This is module';
```

### Экспорт нескольких значений

Модуль может экспортировать несколько значений, если `module.exports` определен как объект:

```js
module.exports = {
  name: 'This is module',
  version: '1.1',
}
```

или

```js
module.exports.name = 'This is module';
module.exports.version = '1.1';
```

### Шорткат `exports`

Допускается также использование шортката, поскольку переменная `exports` определена на уровне файла модуля:

```js
exports.name = 'This is module';
exports.version = '1.1';
```

Следует все же учитывать, что при определении локальной переменной `exports` после использования шортката эта переменная уже не будет связана с `module.exports`.

## Импорт модуля

Экспортированные данные модуля могут быть импортированы в другой файл при помощи `require`:

```js
const { name, version } = require('./module');
```

Эта команда импортирует переменные `name` и `version` из файла `module.js`, находящегося в той же папке. Расширение `.js` указывать не нужно.

### Относительные пути импорта

Импортируемы модули могут располагаться в той же папке, что и основной файл, а так же во вложенных или во внешних папках.

```js
// импорт из модуля в той же папке
const { name } = require('./module');

// импорт из модуля во вложенной папке
const { name } = require('./modules/module');

// импорт из модуля из папки двумя уровнями выше
const { name } = require('../../module');

// импорт из модуля из вложенной папки двумя уровнями выше
const { name } = require('../../modules/module');
```

### Использование общих модулей для приложений и html

Если в статичном html-файле приложения и в вебхендлерах используются одни и те же модули, то для файлов приложения можно использовать модули из папки статичного html.

```js
const jquery = require('./static/modules/jquery.min');
```

Обратный экспорт (в статичный html-файл из внешней папки) невозможен.

<details>
  <summary><strong>ДСП и НДП</strong></summary>
   
   Application Manager использует для модулей формат `CommonJS`, следовательно, в модулях доступны переменные `__dirname`, `__filename`, `module.filename`, `module.id`, `module.path`, `module.paths`.

   Это позволяет пользователю получить информацию о внутренних папках АМ, что, возможно, безвредно, но совершенно не нужно. Следует подумать о том, как отключить или модифицировать значения этих переменных.

</details>